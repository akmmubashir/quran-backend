generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Ayah {
  id              Int           @id @default(autoincrement())
  surahId         Int
  createdAt       DateTime      @default(now())
  ayahInfo        String?
  ayahKey         String
  ayahNumber      Int
  hizbNumber      Int?
  juzNumber       Int?
  pageNumber      Int?
  rubElHizbNumber Int?
  textImlaei      String?
  textUthmani     String?
  surah           Surah         @relation(fields: [surahId], references: [id])
  tafsirs         Tafsir[]
  translations    Translation[]

  @@unique([surahId, ayahNumber])
  @@index([ayahKey])
  @@index([juzNumber])
  @@index([pageNumber])
}

model Juz {
  id          Int   @id @default(autoincrement())
  AyahsCount  Int
  ayahMapping Json?
  firstAyahId Int?
  juzNumber   Int   @unique
  lastAyahId  Int?
}

model Language {
  id         Int     @id @default(autoincrement())
  name       String
  direction  String  @default("ltr")
  iso        String  @unique
  nativeName String?
}

model Surah {
  id              Int           @id @default(autoincrement())
  pages           Int[]         @default([])
  ayahCount       Int
  bismillahPre    Boolean       @default(true)
  nameArabic      String
  nameComplex     String?
  nameEnglish     String?
  revelationOrder Int?
  revelationPlace String?
  surahId         Int           @unique
  surahinfo       String?
  ayahs           Ayah[]
  tafsirs         Tafsir[]
  translations    Translation[]
}

model Tafsir {
  id              Int       @id @default(autoincrement())
  ayah            Ayah?     @relation(fields: [ayahId], references: [id])
  ayahId          Int?
  surah           Surah?    @relation(fields: [surahId], references: [id])
  surahId         Int?
  languageCode    String    // ISO language code
  ayahText        String    @db.Text // The actual tafsir text
  ayahGroupStart  Int?
  ayahGroupEnd    Int?
  scholar         String?   // Scholar/Author name
  source          String?   // Source name (e.g., "Ibn Kathir")

  @@index([languageCode])
  @@index([ayahId])
  @@index([surahId])
}

model Translation {
  id             Int    @id @default(autoincrement())
  ayahId         Int?
  translator     String
  surahId        Int?
  languageCode   String
  ayahText       String
  ayahGroupStart Int?
  ayahGroupEnd   Int?
  ayah           Ayah?  @relation(fields: [ayahId], references: [id])
  surah          Surah? @relation(fields: [surahId], references: [id])

  @@index([ayahId])
  @@index([languageCode])
  @@index([surahId])
}
